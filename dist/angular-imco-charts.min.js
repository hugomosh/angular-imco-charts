"use strict";angular.module("imco.charts",[]).directive("imcoLineChart",["$window",function(a){return{restrict:"EAC",scope:{config:"=?",chartData:"="},template:"<svg></svg>",link:function(b,c,d,e){var f=a.d3,g=c.find("svg")[0],h=function(a){var d=b.chartData.data,e={yDomain:[f.min(d,function(a){return Number(a.y)}),f.max(d,function(a){return Number(a.y)})],dataFormat:",.2f"};b.config||(b.config=e);var h={top:20,right:20,bottom:30,left:40},i=c.width()-h.left-h.right,j=c.height()-h.top-h.bottom,k=b.config.dataFormat?b.config.dataFormat:e.dataFormat,l=f.format(k),m=f.scale.ordinal().domain(d.map(function(a){return a.x})).rangePoints([0,i]),n=f.scale.linear().range([j,0]).domain(b.config.yDomain?b.config.yDomain:e.yDomain),o=f.svg.axis().scale(m).orient("bottom"),p=f.svg.axis().scale(n).orient("left"),q=f.svg.line().defined(function(a){return null!=Number(a.y)}).x(function(a){return m(a.x)}).y(function(a){return n(Number(a.y))}),r=Math.min(c.width(),c.height());r&&0!==r||(r=100);var s=f.select(g).style("width","100%").style("height","100%").attr("viewBox","0, 0, "+r+", "+r).attr("preserveAspectRatio","xMinYMin").datum(d).attr("width",i+h.left+h.right).attr("height",j+h.top+h.bottom).append("g").attr("transform","translate("+h.left+","+h.top+")");s.append("g").attr("class","x axis").attr("transform","translate(0,"+j+")").call(o),s.append("g").attr("class","y axis").attr("transform","translate(-5,0)").call(p),s.append("path").attr("class","line").attr("d",q),s.selectAll(".dot").data(d.filter(function(a){return Number(a.y)})).enter().append("circle").attr("class","dot").attr("cx",q.x()).attr("cy",q.y()).attr("r",3),s.selectAll(".text").data(d.filter(function(a){return Number(a.y)})).enter().append("text").text(function(a){return l(a.y)}).attr("x",q.x()).attr("y",q.y()).attr("font-family","sans-serif").attr("font-size","12px").attr("background-color","white").attr("transform","translate(-20,-10)").attr("fill","#2E9FA3")};b.$watch("chartData",function(a,b){a&&""!==a&&h()})}}}]).directive("imcoBarChart",["$window",function(a){return{restrict:"EAC",scope:{config:"=?",chartData:"="},template:"<svg></svg>",link:function(b,c,d,e){var f=a.d3,g=c.find("svg")[0],h=function(a){var d=b.chartData.data,e={yDomain:[f.min(d,function(a){return Number(a.y)}),f.max(d,function(a){return Number(a.y)})],dataFormat:",.2f"};b.config||(b.config=e);var h={top:20,right:20,bottom:30,left:40},i=c.width()-h.left-h.right,j=c.height()-h.top-h.bottom,k=b.config.dataFormat?b.config.dataFormat:e.dataFormat,l=f.format(k),m=f.scale.ordinal().domain(d.map(function(a){return a.x})).rangePoints([0,i]),n=f.scale.linear().range([j,0]).domain(b.config.yDomain?b.config.yDomain:e.yDomain),o=f.svg.axis().scale(m).orient("bottom"),p=f.svg.axis().scale(n).orient("left"),q=f.svg.line().defined(function(a){return null!=Number(a.y)}).x(function(a){return m(a.x)}).y(function(a){return n(Number(a.y))}),r=Math.min(c.width(),c.height());r&&0!==r||(r=100);var s=f.select(g).style("width","100%").style("height","100%").attr("viewBox","0, 0, "+r+", "+r).attr("preserveAspectRatio","xMinYMin").datum(d).attr("width",i+h.left+h.right).attr("height",j+h.top+h.bottom).append("g").attr("transform","translate("+h.left+","+h.top+")");s.append("g").attr("class","x axis").attr("transform","translate(0,"+j+")").call(o),s.append("g").attr("class","y axis").attr("transform","translate(-5,0)").call(p),s.append("path").attr("class","line").attr("d",q),s.selectAll(".dot").data(d.filter(function(a){return Number(a.y)})).enter().append("circle").attr("class","dot").attr("cx",q.x()).attr("cy",q.y()).attr("r",3),s.selectAll(".text").data(d.filter(function(a){return Number(a.y)})).enter().append("text").text(function(a){return l(a.y)}).attr("x",q.x()).attr("y",q.y()).attr("font-family","sans-serif").attr("font-size","12px").attr("background-color","white").attr("transform","translate(-20,-10)").attr("fill","#2E9FA3")};b.$watch("chartData",function(a,b){a&&""!==a&&h()})}}}]);